<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Alex & Martin's Movie Night Decider</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=Poppins:wght@700;900&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f4f4f5;
            color: #18181b;
        }
        .font-title {
            font-family: 'Poppins', sans-serif;
        }
        .btn {
            font-weight: 600;
            padding: 0.75rem 1.5rem;
            border-radius: 0.5rem;
            transition: background-color 0.3s ease;
            cursor: pointer;
        }
        .btn-primary {
            background-color: #2563eb;
            color: #ffffff;
        }
        .btn-primary:hover {
            background-color: #1d4ed8;
        }
        .btn-secondary {
            display: inline-block;
            text-align: center;
            width: 100%;
            background-color: #b91c1c;
            color: #ffffff;
        }
        .btn-secondary:hover {
            background-color: #991b1b;
        }
        .btn-muted {
            background-color: #d4d4d8;
            color: #18181b;
        }
        .btn-muted:hover {
            background-color: #a1a1aa;
        }
        .imdb-link {
            text-decoration: underline;
            transition: color 0.2s;
        }
        .imdb-link:hover {
            color: #2563eb;
        }
        .view {
            display: none;
        }
        .view.active {
            display: block;
        }
        /* Drag and Drop Styles */
        .ranking-card {
            cursor: move;
            transition: box-shadow 0.2s ease, transform 0.2s ease;
        }
        .ranking-card.dragging {
            opacity: 0.5;
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.2), 0 4px 6px -2px rgba(0, 0, 0, 0.1);
            transform: scale(1.02);
        }
    </style>
</head>
<body>

    <div id="start-view" class="view active container mx-auto px-4 py-8 text-center">
        <h1 class="text-5xl md:text-6xl font-title font-bold text-red-700 tracking-tight">Alex & Martin's Movie Night Decider</h1>
        <div class="max-w-2xl mx-auto mt-8 bg-white p-8 rounded-lg shadow-md border">
            <h2 class="text-3xl font-bold text-zinc-800 mb-4">How It Works</h2>
            <p class="text-lg text-zinc-600 mb-4">
                Welcome! To decide on tonight's movie, you'll go through each film one by one.
            </p>
            <p class="text-lg text-zinc-600 mb-6">
                After you've seen all the options, you'll be able to rank them by dragging and dropping them into your preferred order.
            </p>
            <button id="start-btn" class="btn btn-primary text-xl px-8 py-4">Let's Get Started</button>
        </div>
    </div>

    <div id="movie-view" class="view container mx-auto px-4 py-8">
        <div id="movie-detail-content">
            <!-- Movie details will be injected here -->
        </div>
        <div id="movie-nav" class="flex justify-center items-center gap-4 mt-12">
            <!-- Navigation buttons will be injected here -->
        </div>
    </div>

    <div id="ranking-view" class="view container mx-auto px-4 py-8">
        <header class="text-center mb-12">
            <h1 class="text-5xl md:text-6xl font-title font-bold text-red-700 tracking-tight">Rank Your Choices</h1>
            <p class="text-xl text-zinc-600 mt-2">Drag and drop the movies to set your preference.</p>
        </header>
        <div id="ranking-list" class="max-w-2xl mx-auto space-y-4">
            <!-- Draggable movie cards will be injected here -->
        </div>
         <div class="text-center mt-8 flex justify-center items-center gap-4">
            <button id="back-to-movies-btn" class="btn btn-muted">Previous Movie</button>
            <button id="restart-btn" class="btn btn-primary">Start Over</button>
        </div>
    </div>

    <script type="module">
        // --- DATA ---
        const movieData = {
            "mandy": {
                title: "Mandy",
                year: "2018",
                image: "mandy.jpg",
                trailerId: "rI054ow6KJk",
                synopsis: "In the Pacific Northwest in 1983, a man's peaceful life with his artist partner is shattered by a sadistic cult. This catapults him into a phantasmagoric journey of bloody vengeance, filled with fire and heavy metal.",
                director: { name: "Panos Cosmatos", imdbId: "nm2693225" },
                cast: [{ name: "Nicolas Cage", imdbId: "nm0000115" }, { name: "Andrea Riseborough", imdbId: "nm2057859" }, { name: "Linus Roache", imdbId: "nm0001675" }],
                trivia: ["The demonic biker gang was inspired by the Cenobites from Hellraiser (1987).", "Nicolas Cage's intense bathroom freakout scene was his own creation.", "The film is known for its distinct, surreal visual style."],
                rottenTomatoes: { tomatometer: 90, audience: 66, reviews: ["A gonzo, stylized, and gloriously insane revenge thriller.", "Nicolas Cage delivers one of his most committed performances."] }
            },
            "hero": {
                title: "Hero",
                year: "2002",
                image: "hero.jpg",
                trailerId: "MgsddFEe9Oc",
                synopsis: "In ancient China, a nameless prefect claims to have defeated three assassins who sought to kill the ruthless King of Qin. As he recounts his victories, a complex tale of love, honor, and conflicting loyalties unfolds, questioning the nature of truth itself.",
                director: { name: "Zhang Yimou", imdbId: "nm0955439" },
                cast: [{ name: "Jet Li", imdbId: "nm0001472" }, { name: "Tony Leung", imdbId: "nm0504897" }, { name: "Maggie Cheung", imdbId: "nm0001041" }],
                trivia: ["The film uses different color palettes to represent different versions of the story.", "Director Zhang Yimou waited months for the leaves in a forest to turn the perfect shade of yellow for a fight scene.", "Thousands of actual soldiers were used as extras."],
                rottenTomatoes: { tomatometer: 94, audience: 95, reviews: ["A dazzling martial arts epic with breathtaking visuals.", "Arguably one of the most beautiful wuxia films ever made."] }
            },
            "28-years-later": {
                title: "28 Years Later",
                year: "2025",
                image: "28.jpg.webp",
                trailerId: "mcvLKldPM08",
                synopsis: "Decades after the Rage virus decimated Great Britain, a new generation of survivors must confront the horrifying legacy of the past and a world that has evolved in unimaginable ways. The fight for the future is far from over.",
                director: { name: "Danny Boyle", imdbId: "nm0000965" },
                cast: [{ name: "Cillian Murphy", imdbId: "nm0614165" }, { name: "Jodie Comer", imdbId: "nm3069650" }, { name: "Ralph Fiennes", imdbId: "nm0000146" }],
                trivia: ["This film kicks off a new trilogy, with the first two parts filmed back-to-back.", "Cillian Murphy returns not just as an actor but also as an executive producer.", "It explores different pockets of survivors and the evolution of the Rage virus."],
                rottenTomatoes: { tomatometer: 91, audience: 69, reviews: ["A highly anticipated return to a beloved post-apocalyptic world.", "Critics are praising its bold new direction."] }
            },
            "sorry-baby": {
                title: "Sorry, Baby",
                year: "2025",
                image: "sorry.jpg.webp",
                trailerId: "Rc0jgWoZo9w",
                synopsis: "Something terrible happened to Agnes. But life goes on for everyone else. When a friend visits on the brink of an important milestone, Agnes realizes how stuck she's been, in this bittersweet story of finding your way after your world comes crashing down.",
                director: { name: "Eva Victor", imdbId: "nm9392318" },
                cast: [{ name: "Eva Victor", imdbId: "nm9392318" }, { name: "Patti Harrison", imdbId: "nm6543189" }, { name: "Ayo Edebiri", imdbId: "nm6543222" }],
                trivia: ["The film was shot on location, using natural light to create an intimate, authentic atmosphere.", "Director Eva Victor wrote the screenplay based on personal experiences with grief and friendship.", "The score features a minimalist piano composition to underscore the film's emotional journey."],
                rottenTomatoes: { tomatometer: null, audience: null, reviews: ["A quiet, powerful film about the messy reality of healing.", "Eva Victor's direction is sensitive and insightful, drawing a remarkable performance from its lead."] }
            },
            "revenge": {
                title: "Revenge",
                year: "2017",
                image: "revenge.jpg",
                trailerId: "eIU_IHfp3cU",
                synopsis: "A young woman's romantic getaway with her wealthy boyfriend turns into a nightmare when his friends arrive. After being assaulted and left for dead in the desert, she reemerges as an avenging angel, embarking on a brutal hunt for revenge.",
                director: { name: "Coralie Fargeat", imdbId: "nm4202528" },
                cast: [{ name: "Matilda Lutz", imdbId: "nm4820549" }, { name: "Kevin Janssens", imdbId: "nm0418195" }, { name: "Vincent Colombe", imdbId: "nm0173230" }],
                trivia: ["A stylish take on the rape-revenge subgenre, noted for its vibrant cinematography.", "The director intentionally subverts genre tropes, focusing on resilience over suffering.", "The lead actress, Matilda Lutz, performed many of her own stunts."],
                rottenTomatoes: { tomatometer: 93, audience: 70, reviews: ["A visceral and visually stunning thriller.", "Empowering, gruesome, and unforgettable."] }
            },
            "the-handmaiden": {
                title: "The Handmaiden",
                year: "2016",
                image: "handmaiden.webp",
                trailerId: "whldChqCsYk",
                synopsis: "In 1930s Korea, a pickpocket is hired by a con man to become the handmaiden to a Japanese heiress, as part of a plot to defraud her. However, the plan goes awry when the handmaiden and the heiress develop unexpected feelings for each other.",
                director: { name: "Park Chan-wook", imdbId: "nm0661791" },
                cast: [{ name: "Kim Min-hee", imdbId: "nm0453542" }, { name: "Kim Tae-ri", imdbId: "nm6042261" }, { name: "Ha Jung-woo", imdbId: "nm1833753" }],
                trivia: ["A loose adaptation of the Victorian-era novel 'Fingersmith' by Sarah Waters.", "The film is famous for its intricate plot, told in three parts from different perspectives.", "It won the BAFTA for Best Film Not in the English Language."],
                rottenTomatoes: { tomatometer: 96, audience: 95, reviews: ["A gorgeous, twisty, and deeply sensual thriller.", "A breathtakingly beautiful film that is as clever as it is erotic."] }
            },
            "hundreds-of-beavers": {
                title: "Hundreds of Beavers",
                year: "2022",
                image: "beavers.jpeg",
                trailerId: "5h4P-26kHAw",
                synopsis: "After his applejack distillery is destroyed, a 19th-century salesman must survive a frozen wilderness by trapping animals. He soon finds himself in an epic, slapstick battle against his greatest foe: hundreds of beavers.",
                director: { name: "Mike Cheslik", imdbId: "nm8482813" },
                cast: [{ name: "Ryland Tews", imdbId: "nm8482814" }, { name: "Olivia Graves", imdbId: null }, { name: "Wes Tank", imdbId: "nm3766848" }],
                trivia: ["A black-and-white, dialogue-free comedy inspired by silent films and Looney Tunes.", "It was made on a shoestring budget of around $150,000.", "All animal characters are people in mascot costumes."],
                rottenTomatoes: { tomatometer: 97, audience: 98, reviews: ["An inventive, hilarious, and utterly bonkers tribute to classic slapstick comedy.", "One of the most original and purely entertaining films of the year."] }
            },
            "ainda-estou-aqui": {
                title: "I'm Still Here (Ainda Estou Aqui)",
                year: "2024",
                image: "still.jpg.webp",
                trailerId: "gDunV808Yf4",
                synopsis: "Based on a true story, this film follows Eunice Paiva, a mother of five whose life is upended when her husband, a congressman, disappears during Brazil's military dictatorship. Her tireless search for him transforms her into a formidable activist.",
                director: { name: "Walter Salles", imdbId: "nm0758622" },
                cast: [{ name: "Fernanda Torres", imdbId: "nm0868733" }, { name: "Selton Mello", imdbId: "nm0578334" }, { name: "Fernanda Montenegro", imdbId: "nm0599268" }],
                trivia: ["The film is based on the memoir of Marcelo Rubens Paiva.", "It depicts the true story of Eunice Paiva during Brazil's military dictatorship.", "The film received a standing ovation at the Venice Film Festival."],
                rottenTomatoes: { tomatometer: null, audience: null, reviews: ["A powerful and moving portrait of resilience against oppression.", "Hailed as a masterpiece at the Venice Film Festival."] }
            }
        };
        const movieIdsInOrder = Object.keys(movieData);

        // --- UI ELEMENTS & STATE ---
        const views = document.querySelectorAll('.view');
        const startBtn = document.getElementById('start-btn');
        const restartBtn = document.getElementById('restart-btn');
        const backToMoviesBtn = document.getElementById('back-to-movies-btn');
        const movieDetailContent = document.getElementById('movie-detail-content');
        const movieNav = document.getElementById('movie-nav');
        const rankingList = document.getElementById('ranking-list');
        let currentMovieIndex = 0;

        // --- APP LOGIC ---
        const showView = (viewId) => {
            views.forEach(view => {
                view.classList.toggle('active', view.id === viewId);
            });
            window.scrollTo(0, 0);
        };

        const createPersonLink = (person) => {
            if (person.imdbId) {
                return `<a href="https://www.imdb.com/name/${person.imdbId}/" target="_blank" rel="noopener noreferrer" class="imdb-link">${person.name}</a>`;
            }
            return `<span>${person.name}</span>`;
        };
        
        const renderMoviePage = (index) => {
            currentMovieIndex = index;
            const movieId = movieIdsInOrder[index];
            const movie = movieData[movieId];
            
            movieDetailContent.innerHTML = `
                <div class="grid grid-cols-1 md:grid-cols-3 gap-8">
                    <div class="md:col-span-2">
                        <h1 class="text-5xl md:text-6xl font-title font-bold text-red-700 tracking-tight mb-2">${movie.title} <span class="text-zinc-500 font-normal text-4xl">(${movie.year})</span></h1>
                        <div class="my-4">
                           <img src="${movie.image}" alt="Image for ${movie.title}" class="w-full rounded-lg shadow-md">
                        </div>
                        <a href="https://www.youtube.com/watch?v=${movie.trailerId}" target="_blank" rel="noopener noreferrer" class="btn btn-secondary text-lg">
                            Watch Trailer on YouTube
                        </a>
                        <div class="mt-8">
                            <h3 class="text-3xl font-bold mb-4 text-blue-600">Synopsis</h3>
                            <div class="bg-white p-6 rounded-lg shadow-md border border-zinc-200">
                                <p class="text-lg text-zinc-700">${movie.synopsis}</p>
                            </div>
                        </div>
                        <div class="mt-8">
                             <h3 class="text-3xl font-bold mb-4 text-blue-600">Scores & Reviews</h3>
                             <div class="bg-white p-6 rounded-lg shadow-md border border-zinc-200">
                                <div class="flex flex-wrap gap-8 mb-6">
                                    ${movie.rottenTomatoes.tomatometer ? `<div class="flex items-center"><img src="https://www.rottentomatoes.com/assets/pizza-pie/images/icons/tomatometer/tomatometer-fresh.149b5e8adc3.svg" alt="Tomatometer" class="rotten-tomatoes-logo mr-3"><div><p class="text-lg font-bold">Tomatometer</p><p class="text-3xl font-black">${movie.rottenTomatoes.tomatometer}%</p></div></div>` : ''}
                                    ${movie.rottenTomatoes.audience ? `<div class="flex items-center"><img src="https://www.rottentomatoes.com/assets/pizza-pie/images/icons/audience/aud_score-fresh.6c24d79faaf.svg" alt="Audience Score" class="rotten-tomatoes-logo mr-3"><div><p class="text-lg font-bold">Audience Score</p><p class="text-3xl font-black">${movie.rottenTomatoes.audience}%</p></div></div>` : '<p>No scores available.</p>'}
                                </div>
                                <div class="border-t border-zinc-200 pt-4"><h4 class="text-xl font-bold mb-2">Critic Reviews</h4><div class="space-y-3 text-zinc-600 italic">${movie.rottenTomatoes.reviews.map(review => `<p>"${review}"</p>`).join('')}</div></div>
                             </div>
                        </div>
                    </div>
                    <div class="md:col-span-1">
                        <div class="bg-white p-6 rounded-lg shadow-md border border-zinc-200 sticky top-8">
                            <h3 class="text-2xl font-bold mb-4 text-blue-600">Main Cast</h3>
                            <div class="flex flex-col space-y-2">${movie.cast.map(actor => `<span class="bg-zinc-200 text-zinc-800 px-3 py-1 rounded-full text-lg">${createPersonLink(actor)}</span>`).join('')}</div>
                            <h3 class="text-2xl font-bold mt-8 mb-4 text-blue-600">Director</h3>
                            <div class="flex flex-wrap gap-4"><span class="bg-zinc-200 text-zinc-800 px-3 py-1 rounded-full text-lg">${createPersonLink(movie.director)}</span></div>
                            <h3 class="text-2xl font-bold mt-8 mb-4 text-blue-600">Trivia</h3>
                            <ul class="list-disc list-inside space-y-2 text-zinc-600">${movie.trivia.map(item => `<li>${item}</li>`).join('')}</ul>
                        </div>
                    </div>
                </div>
            `;

            movieNav.innerHTML = '';
            
            if (index > 0) {
                const prevButton = document.createElement('button');
                prevButton.textContent = 'Previous Movie';
                prevButton.className = 'btn btn-muted text-xl px-8 py-4';
                prevButton.addEventListener('click', () => renderMoviePage(index - 1));
                movieNav.appendChild(prevButton);
            }

            const isLastMovie = index === movieIdsInOrder.length - 1;
            const nextButton = document.createElement('button');
            nextButton.textContent = isLastMovie ? 'Go to Ranking' : 'Next Movie';
            nextButton.className = 'btn btn-primary text-xl px-8 py-4';
            nextButton.addEventListener('click', () => {
                if (isLastMovie) {
                    renderRankingPage();
                } else {
                    renderMoviePage(index + 1);
                }
            });
            movieNav.appendChild(nextButton);
            showView('movie-view');
        };

        const renderRankingPage = () => {
            rankingList.innerHTML = '';
            
            movieIdsInOrder.forEach((movieId, index) => {
                const movie = movieData[movieId];
                const card = document.createElement('div');
                card.className = 'ranking-card bg-white p-4 rounded-lg shadow-md border flex items-center space-x-4';
                card.dataset.movieId = movieId;
                card.draggable = true;
                card.innerHTML = `
                    <span class="text-3xl font-bold text-zinc-400 w-8 text-center">${index + 1}</span>
                    <img src="${movie.image}" alt="${movie.title}" class="w-16 h-24 object-cover rounded-md">
                    <div class="flex-grow">
                        <h3 class="text-2xl font-title font-bold text-red-700">${movie.title}</h3>
                        <p class="text-zinc-500">${movie.year}</p>
                    </div>
                `;
                rankingList.appendChild(card);
            });
            
            setupDragAndDrop();
            showView('ranking-view');
        };

        const setupDragAndDrop = () => {
            let draggedItem = null;

            rankingList.addEventListener('dragstart', e => {
                if (e.target.classList.contains('ranking-card')) {
                    draggedItem = e.target;
                    setTimeout(() => {
                        if (draggedItem) draggedItem.classList.add('dragging');
                    }, 0);
                }
            });

            rankingList.addEventListener('dragend', () => {
                if (draggedItem) {
                    draggedItem.classList.remove('dragging');
                }
                draggedItem = null;
            });

            rankingList.addEventListener('dragover', e => {
                e.preventDefault();
                if (!draggedItem) return;
                
                const afterElement = getDragAfterElement(rankingList, e.clientY);
                if (afterElement === null) {
                    rankingList.appendChild(draggedItem);
                } else {
                    rankingList.insertBefore(draggedItem, afterElement);
                }
            });
            
            rankingList.addEventListener('drop', e => {
                e.preventDefault();
                if (!draggedItem) return;

                const rankingCards = rankingList.querySelectorAll('.ranking-card');
                rankingCards.forEach((card, index) => {
                    const numberSpan = card.querySelector('span:first-child');
                    if(numberSpan) numberSpan.textContent = index + 1;
                });
            });
        };

        const getDragAfterElement = (container, y) => {
            const draggableElements = [...container.querySelectorAll('.ranking-card:not(.dragging)')];
            const closest = draggableElements.reduce((closest, child) => {
                const box = child.getBoundingClientRect();
                const offset = y - box.top - box.height / 2;
                if (offset < 0 && offset > closest.offset) {
                    return { offset: offset, element: child };
                } else {
                    return closest;
                }
            }, { offset: Number.NEGATIVE_INFINITY });
            return closest.element || null;
        };

        // --- EVENT LISTENERS ---
        startBtn.addEventListener('click', () => renderMoviePage(0));
        restartBtn.addEventListener('click', () => showView('start-view'));
        backToMoviesBtn.addEventListener('click', () => renderMoviePage(movieIdsInOrder.length - 1));
        
    </script>
</body>
</html>
